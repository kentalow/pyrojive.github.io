---
layout: post
title: Desk.comの更新状況をSlackに流す
category : integration
tagline: 
tags : [slack, desk.com]
---
{% include JB/setup %}

# 背景

所属しているチームで使っている以下のサービスの更新状況を、まとめて把握できるように試行錯誤中です。

社内SNS
: [Yammer](https://www.yammer.com/)

タスク管理
: [Asana](https://asana.com/)

ソースコード／チケット管理
: [Bitbucket](https://bitbucket.org/)

問合せ管理
: [Desk.com](http://www.desk.com/)

APIを使って開発してYammerに集約させてもいいのですが、Yammerの利用目的とは合わなそうですし、よりフローな情報を扱うSlackへ各サービスの更新状況をまとめることにしました。Yammer自体もSlackへ移行することを視野に入れています。

Slackは標準でAsanaとBitbucketに対応していますので、Desk.comを対応させればひとまず完了です。と書きましたが、すでにZapierを使って連携をさせていました。SlackでIncoming Webhooksが使えることがわかったので、Zapier抜きで実現させます。

# Slack側の設定

## Incoming Webhooksの作成

[Incoming Webhooks](https://my.slack.com/services/new/incoming-webhook)より新規Webhookを作成します。 __Instructions for creating Incoming WebHooks__ に今回作成するWebhookのURLが載っていますのでメモしておきます。`https://my.slack.com/services/hooks/incoming-webhook?token=x`のようなURLです。

このURLに対してPOSTで`payload`というパラメーターを送ると、`payload`に含まれる文字列がポストされます。`payload`の中身はJSONで記述し、ポストされる文字列を`text`プロパティで指定します。

	payload={"text": "This is a line of text in a channel.\nAnd this is another line of text."}

またポストする先のチャンネルを指定する必要があります。指定したら`Add Integration`ボタンを押して作成完了です。

# Desk.com側の設定
